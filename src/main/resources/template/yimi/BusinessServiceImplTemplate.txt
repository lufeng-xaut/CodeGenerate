
import com.gurfcc.urfcc.common.enums.EmDeleteFlag;
import com.gurfcc.urfcc.common.utils.UUIDUtil;
import com.gurfcc.urfcc.core.exception.UrfccException;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang.StringUtils;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;


@Slf4j
@Service
@Transactional
public class [(${clazzDefine.clazzName})]BusinessServiceImpl implements [(${clazzDefine.clazzName})]BusinessService {
    @Autowired
    private I[(${clazzDefine.clazzName})]Service [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service;

    /**
     * 根据id查询[(${clazzDefine.clazzComment})]
     *
     * @param id
     * @return
     */
    @Override
    public [(${clazzDefine.clazzName})]Response.Get[(${clazzDefine.clazzName})]Response getById(String id) {
        [(${clazzDefine.clazzName})] [(${#strings.unCapitalize(clazzDefine.clazzName)})] = [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.getById(id);
        if ([(${#strings.unCapitalize(clazzDefine.clazzName)})] == null) {
            return null;
        }
        [(${clazzDefine.clazzName})]Response.Get[(${clazzDefine.clazzName})]Response response = new [(${clazzDefine.clazzName})]Response.Get[(${clazzDefine.clazzName})]Response();
        BeanUtils.copyProperties([(${#strings.unCapitalize(clazzDefine.clazzName)})], response);
        return response;
    }

    /**
     * 新增/编辑[(${clazzDefine.clazzComment})]
     *
     * @param request
     * @return
     */
    @Override
    public [(${clazzDefine.clazzName})]Response.Save[(${clazzDefine.clazzName})]Response save[(${clazzDefine.clazzName})]([(${clazzDefine.clazzName})]Request.Save[(${clazzDefine.clazzName})]Request request) {
        String currentUserId = request.getCurrentUserId();
        String [(${#strings.unCapitalize(clazzDefine.clazzName)})]Id = request1.get[(${clazzDefine.clazzName})]Id();

        [(${clazzDefine.clazzName})] [(${#strings.unCapitalize(clazzDefine.clazzName)})] = new [(${clazzDefine.clazzName})]();
        BeanUtils.copyProperties(request, [(${#strings.unCapitalize(clazzDefine.clazzName)})]);

        if (StringUtils.isBlank([(${#strings.unCapitalize(clazzDefine.clazzName)})]Id)) {
            [(${#strings.unCapitalize(clazzDefine.clazzName)})].set[(${clazzDefine.clazzName})]Id(UUIDUtil.getOriginalUUID());
            [(${#strings.unCapitalize(clazzDefine.clazzName)})].setCreateUser(currentUserId);
            [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.save([(${#strings.unCapitalize(clazzDefine.clazzName)})]);
        } else {
            [(${clazzDefine.clazzName})] old[(${clazzDefine.clazzName})] = [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.getById(request.get[(${clazzDefine.clazzName})]Id());
            if (old[(${clazzDefine.clazzName})] == null) {
                throw new UrfccException(Em[(${clazzDefine.clazzName})]ErrorCode.[(${#strings.toUpperCase(clazzDefine.clazzName)})]_xx0000.getMsg());
            }
            [(${#strings.unCapitalize(clazzDefine.clazzName)})].set[(${clazzDefine.clazzName})]Id([(${#strings.unCapitalize(clazzDefine.clazzName)})]Id);
            [(${#strings.unCapitalize(clazzDefine.clazzName)})].setEditUser(currentUserId);
            [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.updateById([(${#strings.unCapitalize(clazzDefine.clazzName)})]);
        }

        [(${clazzDefine.clazzName})]Response.Save[(${clazzDefine.clazzName})]Response response = new [(${clazzDefine.clazzName})]Response.Save[(${clazzDefine.clazzName})]Response();
        BeanUtils.copyProperties([(${#strings.unCapitalize(clazzDefine.clazzName)})], response);
        return response;
    }

    /**
     * 删除[(${clazzDefine.clazzComment})]
     *
     * @param request
     * @return
     */
    @Override
    public void delete[(${clazzDefine.clazzName})]([(${clazzDefine.clazzName})]Request.Delete[(${clazzDefine.clazzName})]Request request) {
         String currentUserId = request.getCurrentUserId();
         String [(${#strings.unCapitalize(clazzDefine.clazzName)})]Id = request1.get[(${clazzDefine.clazzName})]Id();

        [(${clazzDefine.clazzName})] [(${#strings.unCapitalize(clazzDefine.clazzName)})] = [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.getById([(${#strings.unCapitalize(clazzDefine.clazzName)})]Id);
        if ([(${#strings.unCapitalize(clazzDefine.clazzName)})] == null) {
            throw new UrfccException(Em[(${clazzDefine.clazzName})]ErrorCode.[(${#strings.toUpperCase(clazzDefine.clazzName)})]_xx0000.getMsg());
        }
        [(${clazzDefine.clazzName})] updateEntity = new [(${clazzDefine.clazzName})]();
        updateEntity.set[(${clazzDefine.clazzName})]Id([(${#strings.unCapitalize(clazzDefine.clazzName)})].get[(${clazzDefine.clazzName})]Id());
        updateEntity.setDeleteFlag(EmDeleteFlag.enableFlag_2.getValue());
        [(${#strings.unCapitalize(clazzDefine.clazzName)})].setEditUser(currentUserId);
        [(${#strings.unCapitalize(clazzDefine.clazzName)})]Service.updateById(updateEntity);
    }

    /**
     * 管理后台-分页查询[(${clazzDefine.clazzComment})]
     *
     * @param request1
     * @return
     */
    @Override
    public IPage<[(${clazzDefine.clazzName})]Response.Get[(${clazzDefine.clazzName})]Response> page[(${clazzDefine.clazzName})]Admin([(${clazzDefine.clazzName})]Request.Page[(${clazzDefine.clazzName})]Request request1) {
        Page<Object> pageParam = new Page<>(request1.getPageIndex(), request1.getPageSize());
        IPage<[(${clazzDefine.clazzName})]Response.Get[(${clazzDefine.clazzName})]Response> result = [(${#strings.unCapitalize(clazzDefine.clazzName)})]BusinessMapper.page[(${clazzDefine.clazzName})]Admin(pageParam, request1);
        return result;
    }



}
